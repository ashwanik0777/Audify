<!DOCTYPE html>
<html>
<head>
    <title>Test Playlist</title>
</head>
<body>
    <h1>Testing Playlist Loading</h1>
    <div id="results"></div>
    <div id="cards"></div>

    <script>
        async function testFetch() {
            console.log("Testing fetch...");
            try {
                // Test 1: Fetch songs directory
                let response = await fetch(`http://localhost:5500/songs/`);
                console.log("Songs directory status:", response.status);
                let html = await response.text();
                console.log("HTML length:", html.length);
                
                // Parse HTML
                let div = document.createElement("div");
                div.innerHTML = html;
                let anchors = div.getElementsByTagName("a");
                console.log("Found anchors:", anchors.length);
                
                let results = document.getElementById("results");
                results.innerHTML = "<h2>Found Folders:</h2>";
                
                for (let i = 0; i < anchors.length; i++) {
                    let link = anchors[i];
                    console.log("Link:", link.href);
                    
                    if (link.href.includes("/songs/") && !link.href.includes(".htaccess") && !link.href.endsWith("/songs")) {
                        let folder = link.href.split("/").slice(-1)[0];
                        results.innerHTML += `<p>Folder: ${folder}</p>`;
                        
                        // Test info.json fetch
                        try {
                            let infoResponse = await fetch(`http://localhost:5500/songs/${folder}/info.json`);
                            if (infoResponse.ok) {
                                let info = await infoResponse.json();
                                results.innerHTML += `<p>- Title: ${info.title}, Description: ${info.description}</p>`;
                                
                                // Create card
                                let cardsDiv = document.getElementById("cards");
                                cardsDiv.innerHTML += `
                                    <div style="border: 1px solid #ccc; padding: 10px; margin: 10px; width: 200px; display: inline-block;">
                                        <h3>${info.title}</h3>
                                        <p>${info.description}</p>
                                        <p>Folder: ${decodeURIComponent(folder)}</p>
                                    </div>
                                `;
                            } else {
                                results.innerHTML += `<p>- Failed to load info.json (${infoResponse.status})</p>`;
                            }
                        } catch (error) {
                            results.innerHTML += `<p>- Error loading info.json: ${error.message}</p>`;
                        }
                    }
                }
            } catch (error) {
                console.error("Error:", error);
                document.getElementById("results").innerHTML = `<p>Error: ${error.message}</p>`;
            }
        }
        
        testFetch();
    </script>
</body>
</html>
